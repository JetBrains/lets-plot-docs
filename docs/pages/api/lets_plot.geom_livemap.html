<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lets_plot.geom_livemap &#8212; lets-plot 2.0.2 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../../_static/js/custom.js"></script>
    <script src="../../_static/js/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          Lets-Plot</a>
        <span class="navbar-text navbar-version pull-left"><b>2.0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../../gallery/index.html">Gallery</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">lets_plot.geom_livemap</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="lets-plot-geom-livemap">
<h1>lets_plot.geom_livemap<a class="headerlink" href="#lets-plot-geom-livemap" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="lets_plot.geom_livemap">
<code class="sig-prename descclassname"><span class="pre">lets_plot.</span></code><code class="sig-name descname"><span class="pre">geom_livemap</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tooltips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_join</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geodesic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">other_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lets_plot.geom_livemap" title="Permalink to this definition">¶</a></dt>
<dd><p>Display an interactive map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mapping</strong> (<cite>FeatureSpec</cite>) – Set of aesthetic mappings created by <cite>aes()</cite> function.
Aesthetic mappings describe the way that variables in the data are
mapped to plot “aesthetics”.</p></li>
<li><p><strong>data</strong> (dict or <cite>DataFrame</cite> or <cite>GeoDataFrame</cite>) – The data to be displayed in this layer. If None, the default, the data
is inherited from the plot data as specified in the call to ggplot.</p></li>
<li><p><strong>show_legend</strong> (<em>bool, default=True</em>) – False - do not show legend for this layer.</p></li>
<li><p><strong>sampling</strong> (<cite>FeatureSpec</cite>) – Result of the call to the <cite>sampling_xxx()</cite> function.
Value None (or ‘none’) will disable sampling for this layer.</p></li>
<li><p><strong>tooltips</strong> (<cite>layer_tooltips</cite>) – Result of the call to the <cite>layer_tooltips()</cite> function.
Specifies appearance, style and content.</p></li>
<li><p><strong>map</strong> (<cite>GeoDataFrame</cite> or <cite>Geocoder</cite>) – Data containing coordinates of points.</p></li>
<li><p><strong>map_join</strong> (<em>str or list</em>) – Keys used to join map coordinates with data.
First value in pair - column/columns in <cite>data</cite>.
Second value in pair - column/columns in <cite>map</cite>.</p></li>
<li><p><strong>symbol</strong> (<em>str</em>) – The marker used for displaying the data. There are:
‘point’ for circles of different size and color; ‘pie’ for pie charts;
‘bar’ for bar charts.</p></li>
<li><p><strong>location</strong> (<em>list</em>) – Initial position of the map. If not set, displays the United States.
There are [lon1, lat1, lon2, lat2,…, lonN, latN]:
lon1, lon2,…, lonN are longitudes in degrees (positive in the Eastern hemisphere);
lat1, lat2,…, latN are latitudes in degrees (positive in the Northern hemisphere).</p></li>
<li><p><strong>zoom</strong> (<em>int</em>) – Zoom of the map in the range 1 - 15.</p></li>
<li><p><strong>projection</strong> (<em>str, default=’epsg3857’</em>) – The map projection. There are: ‘epsg3857’ for Mercator projection;
‘epsg4326’ for Equirectangular projection. <cite>projection</cite> only works
with vector map tiles (i.e. Lets-Plot map tiles).</p></li>
<li><p><strong>geodesic</strong> (<em>bool, default=True</em>) – Enables geodesic type of all paths and segments.</p></li>
<li><p><strong>tiles</strong> (<em>str</em>) – Tiles provider, either as a string - URL for a standard raster ZXY tile provider
with {z}, {x} and {y} wildcards (e.g. ‘<a class="reference external" href="http://my.tile.com">http://my.tile.com</a>/{z}/{x}/{y}.png’)
or the result of a call to a <cite>maptiles_xxx()</cite> functions.</p></li>
<li><p><strong>other_args</strong> – Other arguments passed on to the layer.
These are often aesthetics settings used to set an aesthetic to a fixed value,
like color=’red’, fill=’blue’, size=3 or shape=21.
They may also be parameters to the paired geom/stat.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Geom object specification.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>LayerSpec</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>geom_livemap()</cite> draws map, which can be moved and zoomed.</p>
<p><cite>geom_livemap()</cite> understands the following aesthetics mappings:</p>
<ul class="simple">
<li><p>alpha : transparency level of the point. Understands numbers between 0 and 1.</p></li>
<li><p>color (colour) : color of the geometry lines. Can be continuous or discrete. For continuous value this will be a color gradient between two colors.</p></li>
<li><p>fill : color of a geometry internals. Can be continuous or discrete. For continuous value this will be a color gradient between two colors.</p></li>
<li><p>size : radius for point, pie chart.</p></li>
<li><p>sym_x : value order for pie chart and bar chart.</p></li>
<li><p>sym_y : value specifying the sector size for pie chart and the heigth for bar chart.</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>data</cite> and <cite>map</cite> parameters of <cite>GeoDataFrame</cite> type support shapes <cite>Point</cite> and <cite>MultiPoint</cite>.</p>
<p>The <cite>map</cite> parameter of <cite>Geocoder</cite> type implicitly invoke <cite>centroids()</cite> function.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The conventions for the values of <cite>map_join</cite> parameter are as follows.</p>
<ul>
<li><p>Joining data and <cite>GeoDataFrame</cite> object</p>
<p>Data has a column named ‘State_name’ and <cite>GeoDataFrame</cite> has a matching column named ‘state’:</p>
<ul class="simple">
<li><p>map_join=[‘State_Name’, ‘state’]</p></li>
<li><p>map_join=[[‘State_Name’], [‘state’]]</p></li>
</ul>
</li>
<li><p>Joining data and <cite>Geocoder</cite> object</p>
<p>Data has a column named ‘State_name’. The matching key in <cite>Geocoder</cite> is always ‘state’ (providing it is a state-level geocoder) and can be omitted:</p>
<ul class="simple">
<li><p>map_join=’State_Name’</p></li>
<li><p>map_join=[‘State_Name’]</p></li>
</ul>
</li>
<li><p>Joining data by composite key</p>
<p>Joining by composite key works like in examples above, but instead of using a string for a simple key you need to use an array of strings for a composite key. The names in the composite key must be in the same order as in the US street addresses convention: ‘city’, ‘county’, ‘state’, ‘country’. For example, the data has columns ‘State_name’ and ‘County_name’. Joining with a 2-keys county level <cite>Geocoder</cite> object (the <cite>Geocoder</cite> keys ‘county’ and ‘state’ are omitted in this case):</p>
<ul class="simple">
<li><p>map_join=[‘County_name’, ‘State_Name’]</p></li>
</ul>
</li>
</ul>
</div>
<p class="rubric">Examples</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lets_plot</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">LetsPlot</span><span class="o">.</span><span class="n">setup_html</span><span class="p">()</span>
<span class="hll"><span class="n">ggplot</span><span class="p">()</span> <span class="o">+</span> <span class="n">geom_livemap</span><span class="p">()</span>
</span></pre></div>
</td></tr></table></div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="9pxbus"></div>
<script type="text/javascript" data-lets-plot-script="library">
    if(!window.letsPlotCallQueue) {
        window.letsPlotCallQueue = [];
    }; 
    window.letsPlotCall = function(f) {
        window.letsPlotCallQueue.push(f);
    };
    (function() {
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = "https://cdnjs.cloudflare.com/ajax/libs/lets-plot/2.0.2/lets-plot.min.js";
        script.onload = function() {
            window.letsPlotCall = function(f) {f();};
            window.letsPlotCallQueue.forEach(function(f) {f();});
            window.letsPlotCallQueue = [];

        };
        script.onerror = function(event) {
            window.letsPlotCall = function(f) {};    // noop
            window.letsPlotCallQueue = [];
            var div = document.createElement("div");
            div.style.color = 'darkred';
            div.textContent = 'Error loading Lets-Plot JS';
            document.getElementById("9pxbus").appendChild(div);
        };
        var e = document.getElementById("9pxbus");
        e.appendChild(script);
    })()
</script>
</div><div class="output text_html">   <div id="1JwW0y"></div>
   <script type="text/javascript" data-lets-plot-script="plot">
       (function() {
           var plotSpec={
'mapping':{
},
'data_meta':{
},
'kind':"plot",
'scales':[],
'layers':[{
'geom':"livemap",
'mapping':{
},
'data_meta':{
},
'tiles':{
'kind':"vector_lets_plot",
'url':"wss://tiles.datalore.jetbrains.com",
'theme':"color",
'attribution':"Map: <a href=\"https://github.com/JetBrains/lets-plot\">© Lets-Plot</a>, map data: <a href=\"https://www.openstreetmap.org/copyright\">© OpenStreetMap contributors</a>."
},
'geocoding':{
'url':"https://geo2.datalore.jetbrains.com"
},
'data':{
}
}]
};
           var plotContainer = document.getElementById("1JwW0y");
           window.letsPlotCall(function() {{
               LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer);
           }});
       })();    
   </script></div></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lets_plot</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">LetsPlot</span><span class="o">.</span><span class="n">setup_html</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York City&#39;</span><span class="p">,</span> <span class="s1">&#39;Singapore&#39;</span><span class="p">],</span>
    <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">73.7997</span><span class="p">,</span> <span class="mf">104.0012</span><span class="p">],</span>
    <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">40.6408</span><span class="p">,</span> <span class="mf">1.3256</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">))</span> <span class="o">+</span> \
<span class="hll">    <span class="n">geom_livemap</span><span class="p">(</span><span class="n">geodesic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;epsg4326&#39;</span><span class="p">,</span> \
</span><span class="hll">                 <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;point&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> \
</span><span class="hll">                 <span class="n">tiles</span><span class="o">=</span><span class="n">maptiles_lets_plot</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="s1">&#39;dark&#39;</span><span class="p">),</span> \
</span><span class="hll">                 <span class="n">tooltips</span><span class="o">=</span><span class="n">layer_tooltips</span><span class="p">()</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;@city&#39;</span><span class="p">)</span>\
</span><span class="hll">                                          <span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">))</span> <span class="o">+</span> \
</span>    <span class="n">geom_path</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">ggtitle</span><span class="p">(</span><span class="s1">&#39;SQ23 - the longest scheduled airline flight &#39;</span>
            <span class="s1">&#39;by great circle distance since 2020&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="V1nAkS"></div>
<script type="text/javascript" data-lets-plot-script="library">
    if(!window.letsPlotCallQueue) {
        window.letsPlotCallQueue = [];
    }; 
    window.letsPlotCall = function(f) {
        window.letsPlotCallQueue.push(f);
    };
    (function() {
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = "https://cdnjs.cloudflare.com/ajax/libs/lets-plot/2.0.2/lets-plot.min.js";
        script.onload = function() {
            window.letsPlotCall = function(f) {f();};
            window.letsPlotCallQueue.forEach(function(f) {f();});
            window.letsPlotCallQueue = [];

        };
        script.onerror = function(event) {
            window.letsPlotCall = function(f) {};    // noop
            window.letsPlotCallQueue = [];
            var div = document.createElement("div");
            div.style.color = 'darkred';
            div.textContent = 'Error loading Lets-Plot JS';
            document.getElementById("V1nAkS").appendChild(div);
        };
        var e = document.getElementById("V1nAkS");
        e.appendChild(script);
    })()
</script>
</div><div class="output text_html">   <div id="cinuPC"></div>
   <script type="text/javascript" data-lets-plot-script="plot">
       (function() {
           var plotSpec={
'data':{
'city':["New York City","Singapore"],
'lat':[-73.7997,104.0012],
'lon':[40.6408,1.3256]
},
'mapping':{
'x':"lat",
'y':"lon"
},
'data_meta':{
},
'ggtitle':{
'text':"SQ23 - the longest scheduled airline flight by great circle distance since 2020"
},
'kind':"plot",
'scales':[],
'layers':[{
'geom':"livemap",
'mapping':{
},
'tooltips':{
'tooltip_formats':[],
'tooltip_lines':["@city"],
'tooltip_color':"black"
},
'data_meta':{
},
'display_mode':"point",
'projection':"epsg4326",
'geodesic':false,
'tiles':{
'kind':"vector_lets_plot",
'url':"wss://tiles.datalore.jetbrains.com",
'theme':"dark",
'attribution':"Map: <a href=\"https://github.com/JetBrains/lets-plot\">© Lets-Plot</a>, map data: <a href=\"https://www.openstreetmap.org/copyright\">© OpenStreetMap contributors</a>."
},
'geocoding':{
'url':"https://geo2.datalore.jetbrains.com"
},
'color':"white",
'data':{
}
},{
'geom':"path",
'mapping':{
},
'data_meta':{
},
'color':"white",
'data':{
}
}]
};
           var plotContainer = document.getElementById("cinuPC");
           window.letsPlotCall(function() {{
               LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer);
           }});
       })();    
   </script></div></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">lets_plot</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">lets_plot.geo_data</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">LetsPlot</span><span class="o">.</span><span class="n">setup_html</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="s1">&#39;NY&#39;</span><span class="p">,</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;PA&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span>
    <span class="s1">&#39;spoken_lang&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="s1">&#39;English&#39;</span><span class="p">,</span> <span class="s1">&#39;Spanish&#39;</span><span class="p">,</span> <span class="s1">&#39;Chinese&#39;</span><span class="p">,</span> <span class="s1">&#39;Other&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span>
    <span class="s1">&#39;lang_order&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">3</span><span class="p">),</span>
    <span class="s1">&#39;percentage_2020&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">69.6</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">12.1</span><span class="p">,</span> <span class="mf">77.7</span><span class="p">,</span> <span class="mf">8.6</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">11.6</span><span class="p">,</span> <span class="mf">90.2</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">geocode_states</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">scope</span><span class="p">(</span><span class="s1">&#39;US&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_centroids</span><span class="p">()</span>
<span class="n">tiles</span> <span class="o">=</span> <span class="n">maptiles_zxy</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://c.tile.stamen.com/terrain/</span><span class="si">{z}</span><span class="s1">/</span><span class="si">{x}</span><span class="s1">/</span><span class="si">{y}</span><span class="s1">@2x.png&#39;</span><span class="p">,</span>
                     <span class="n">attribution</span><span class="o">=</span><span class="s1">&#39;Map tiles by &lt;a href=&quot;http://stamen.com&quot;&gt;Stamen Design&lt;/a&gt;, &#39;</span>
                                 <span class="s1">&#39;under &lt;a href=&quot;http://creativecommons.org/licenses/by/3.0&quot;&gt;CC BY 3.0&lt;/a&gt;. &#39;</span>
                                 <span class="s1">&#39;Data by &lt;a href=&quot;http://openstreetmap.org&quot;&gt;OpenStreetMap&lt;/a&gt;, &#39;</span>
                                 <span class="s1">&#39;under &lt;a href=&quot;http://www.openstreetmap.org/copyright&quot;&gt;ODbL&lt;/a&gt;&#39;</span><span class="p">)</span>
<span class="hll"><span class="n">ggplot</span><span class="p">()</span> <span class="o">+</span> <span class="n">geom_livemap</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;spoken_lang&#39;</span><span class="p">,</span> <span class="n">sym_x</span><span class="o">=</span><span class="s1">&#39;lang_order&#39;</span><span class="p">,</span> <span class="n">sym_y</span><span class="o">=</span><span class="s1">&#39;percentage_2020&#39;</span><span class="p">),</span> \
</span><span class="hll">                        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="nb">map</span><span class="o">=</span><span class="n">centroids</span><span class="p">,</span> <span class="n">map_join</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;pie&#39;</span><span class="p">,</span> <span class="n">tiles</span><span class="o">=</span><span class="n">tiles</span><span class="p">,</span> \
</span><span class="hll">                        <span class="n">zoom</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">76.09990</span><span class="p">,</span> <span class="mf">42.86217</span><span class="p">],</span> <span class="n">show_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> \
</span><span class="hll">                        <span class="n">tooltips</span><span class="o">=</span><span class="n">layer_tooltips</span><span class="p">()</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;Spoken language in @{found name}&#39;</span><span class="p">)</span>\
</span><span class="hll">                                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;percentage_2020&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">%&#39;</span><span class="p">)</span>\
</span><span class="hll">                                                 <span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;@spoken_lang @percentage_2020&#39;</span><span class="p">))</span>
</span></pre></div>
</td></tr></table></div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>The geodata is provided by © OpenStreetMap contributors and is made available here under the Open Database License (ODbL).
</pre></div>
</div>
<div class="output text_html">
<div id="HHb52F"></div>
<script type="text/javascript" data-lets-plot-script="library">
    if(!window.letsPlotCallQueue) {
        window.letsPlotCallQueue = [];
    }; 
    window.letsPlotCall = function(f) {
        window.letsPlotCallQueue.push(f);
    };
    (function() {
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = "https://cdnjs.cloudflare.com/ajax/libs/lets-plot/2.0.2/lets-plot.min.js";
        script.onload = function() {
            window.letsPlotCall = function(f) {f();};
            window.letsPlotCallQueue.forEach(function(f) {f();});
            window.letsPlotCallQueue = [];

        };
        script.onerror = function(event) {
            window.letsPlotCall = function(f) {};    // noop
            window.letsPlotCallQueue = [];
            var div = document.createElement("div");
            div.style.color = 'darkred';
            div.textContent = 'Error loading Lets-Plot JS';
            document.getElementById("HHb52F").appendChild(div);
        };
        var e = document.getElementById("HHb52F");
        e.appendChild(script);
    })()
</script>
</div><div class="output text_html">   <div id="ZSKZYQ"></div>
   <script type="text/javascript" data-lets-plot-script="plot">
       (function() {
           var plotSpec={
'mapping':{
},
'data_meta':{
},
'kind':"plot",
'scales':[],
'layers':[{
'geom':"livemap",
'data':{
'state':["NY","NY","NY","NY","MA","MA","MA","MA","PA","PA","PA","PA"],
'spoken_lang':["English","Spanish","Chinese","Other","English","Spanish","Chinese","Other","English","Spanish","Chinese","Other"],
'lang_order':[0.0,1.0,2.0,3.0,0.0,1.0,2.0,3.0,0.0,1.0,2.0,3.0],
'percentage_2020':[69.6,15.2,3.1,12.1,77.7,8.6,2.1,11.6,90.2,4.1,0.5,5.2]
},
'mapping':{
'fill':"spoken_lang",
'sym_x':"lang_order",
'sym_y':"percentage_2020"
},
'show_legend':false,
'tooltips':{
'tooltip_formats':[{
'field':"percentage_2020",
'format':"{}%"
}],
'tooltip_lines':["Spoken language in @{found name}","@spoken_lang @percentage_2020"]
},
'data_meta':{
},
'map_data_meta':{
'geodataframe':{
'geometry':"geometry"
}
},
'map':{
'state':["NY","NY","NY","NY","MA","MA","MA","MA","PA","PA","PA","PA"],
'found name':["New York","New York","New York","New York","Massachusetts","Massachusetts","Massachusetts","Massachusetts","Pennsylvania","Pennsylvania","Pennsylvania","Pennsylvania"],
'geometry':["{\"type\": \"Point\", \"coordinates\": [-76.0999038136662, 42.8621687740088]}","{\"type\": \"Point\", \"coordinates\": [-76.0999038136662, 42.8621687740088]}","{\"type\": \"Point\", \"coordinates\": [-76.0999038136662, 42.8621687740088]}","{\"type\": \"Point\", \"coordinates\": [-76.0999038136662, 42.8621687740088]}","{\"type\": \"Point\", \"coordinates\": [-72.0964509143505, 42.1913791447878]}","{\"type\": \"Point\", \"coordinates\": [-72.0964509143505, 42.1913791447878]}","{\"type\": \"Point\", \"coordinates\": [-72.0964509143505, 42.1913791447878]}","{\"type\": \"Point\", \"coordinates\": [-72.0964509143505, 42.1913791447878]}","{\"type\": \"Point\", \"coordinates\": [-77.7395653681049, 41.1167051643133]}","{\"type\": \"Point\", \"coordinates\": [-77.7395653681049, 41.1167051643133]}","{\"type\": \"Point\", \"coordinates\": [-77.7395653681049, 41.1167051643133]}","{\"type\": \"Point\", \"coordinates\": [-77.7395653681049, 41.1167051643133]}"]
},
'map_join':[["state"],["state"]],
'display_mode':"pie",
'location':{
'type':"coordinates",
'data':[-76.0999,42.86217]
},
'zoom':6,
'tiles':{
'kind':"raster_zxy",
'url':"http://c.tile.stamen.com/terrain/{z}/{x}/{y}@2x.png",
'attribution':"Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>"
},
'geocoding':{
'url':"https://geo2.datalore.jetbrains.com"
},
'color':"black"
}]
};
           var plotContainer = document.getElementById("ZSKZYQ");
           window.letsPlotCall(function() {{
               LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer);
           }});
       })();    
   </script></div></div>
</div>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
    </p>
    <p>
      Copyright © 2019-2021 JetBrains s.r.o.<br>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
    </p>
  </div>
</footer>

  </body>
</html>